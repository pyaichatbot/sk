events {
    worker_connections 1024;
}

http {
    server {
        listen 80;
        server_name localhost;

        # Health check endpoint
        location /health {
            return 200 '{"status": "healthy", "service": "search-agent", "version": "1.0.0"}';
            add_header Content-Type application/json;
        }

        # Service info endpoint
        location /service-info {
            return 200 '{"service_name": "search-agent", "port": 8003, "health_endpoint": "/health", "tags": ["search-agent", "agent", "search"], "metadata": {"version": "1.0.0", "capabilities": ["search", "information_retrieval", "query_processing"]}}';
            add_header Content-Type application/json;
        }

        # Discovery metrics endpoint
        location /discovery-metrics {
            return 200 '{"service_name": "search-agent", "registered": true, "health_score": 1.0, "last_health_check": "'$(date -u +%Y-%m-%dT%H:%M:%SZ)'"}';
            add_header Content-Type application/json;
        }

        # Mock agent processing endpoint
        location /process {
            if ($request_method = POST) {
                return 200 '{"content": "Mock Search response: I found 5 relevant documents about your query. Here are the key findings: [Document 1: AI fundamentals], [Document 2: Machine learning basics], [Document 3: Deep learning concepts].", "success": true, "metadata": {"results_count": 5, "search_time": 0.3, "sources": ["source1", "source2", "source3"]}}';
                add_header Content-Type application/json;
            }
            return 405 '{"error": "Method not allowed"}';
            add_header Content-Type application/json;
        }

        # Default response
        location / {
            return 200 '{"service": "search-agent", "status": "running", "endpoints": ["/health", "/service-info", "/discovery-metrics", "/process"]}';
            add_header Content-Type application/json;
        }
    }
}
